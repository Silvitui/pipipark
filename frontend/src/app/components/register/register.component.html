<div class="register-wrapper relative min-h-screen w-full">
  <div class="background-image absolute inset-0 z-0"></div>
  <div class="register-layout relative z-10 flex items-center justify-center min-h-screen px-2 sm:px-4">
    <div
      class="register-box w-full max-w-sm bg-white  sm:p-6 rounded-3xl shadow-xl border-4 border-gray-300  "
      [ngClass]="animationClass()"
      (animationend)="onAnimationEnd()"
    >
   
      <button 
        (click)="goToHome()"
        class="btn btn-circle btn-outline absolute top-3 right-3 hover:bg-purple-500 hover:text-white transition"
      >
        <svg xmlns="http://www.w3.org/2000/svg"
             class="h-5 w-5"
             fill="none"
             viewBox="0 0 24 24"
             stroke="currentColor">
          <path stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
      <div class="flex justify-center mb-3">
        <img 
          src="assets/logoperrito.png" 
          alt="ConnectaPet" 
          class="w-16 h-16 rounded-full shadow border border-purple-300" 
        />
      </div>
      <h2 class="text-sm sm:text-base font-semibold text-center text-gray-800 mb-3">
        {{ questions[currentStep()].question }}
      </h2>

      @if (['text', 'email', 'password'].includes(questions[currentStep()].type)) {
        <input 
          type="{{ questions[currentStep()].type }}" 
          [(ngModel)]="answers()[questions[currentStep()].field]" 
          class="w-full input input-bordered px-3 py-2 mb-3 shadow-sm rounded-md text-xs sm:text-sm"
          placeholder="Escribe aqu√≠..."
          (keyup.enter)="nextStep()" />
      }

    
      @if (questions[currentStep()].type === 'number') {
        <input 
          type="number"
          [(ngModel)]="answers()[questions[currentStep()].field]"
          class="w-full input input-bordered px-3 py-2 mb-3 shadow-sm rounded-md text-xs sm:text-sm"
          placeholder="Introduce la edad"
          min="0"
          (keyup.enter)="nextStep()" />
      }

      @if (questions[currentStep()].type === 'size') {
        <input 
          type="text"
          [(ngModel)]="answers()[questions[currentStep()].field]"
          class="w-full input input-bordered px-3 py-2 mb-3 shadow-sm rounded-md text-xs sm:text-sm"
          placeholder="Peque√±o, mediano, grande..."
          (keyup.enter)="nextStep()" />
      }

      @if (questions[currentStep()].type === 'multi-select') {
        <div class="grid grid-cols-2 gap-2 mb-3">
          @for (option of questions[currentStep()].options; track option) {
            <label class="flex items-center bg-purple-100 hover:bg-purple-200 text-purple-900 font-medium px-2 py-1 rounded-md cursor-pointer transition text-xs sm:text-sm">
              <input 
                type="checkbox" 
                (change)="addPersonality(option)" 
                [checked]="answers()['personality']?.includes(option)"
                class="checkbox checkbox-sm checkbox-primary" />
              <span class="ml-1">{{ option }}</span>
            </label>
          }
        </div>
      }

      @if (questions[currentStep()].type === 'file') {
        <label for="file-upload" class="block w-full text-center text-purple-600 border-2 border-dashed border-purple-300 py-3 rounded-lg cursor-pointer hover:bg-purple-50 mb-3 text-xs sm:text-sm">
          üì∑ Haz clic aqu√≠ para subir una foto
        </label>
        <input type="file" id="file-upload" (change)="handleFileInput($event)" class="hidden" />
      }
      <div class="flex justify-between mt-3 space-x-2">
        @if (currentStep() > 0) {
          <button 
            class="btn bg-white border border-purple-400 text-purple-600 hover:bg-purple-100 transition text-xs sm:text-sm"
            (click)="prevStep()"
          >
            ‚Üê Atr√°s
          </button>
        }
        @if (currentStep() < questions.length - 1) {
          <button 
            class="btn bg-purple-500 text-white hover:bg-purple-600 transition text-xs sm:text-sm"
            (click)="nextStep()"
          >
            Siguiente ‚Üí
          </button>
        }
        @if (currentStep() === questions.length - 1) {
          <button 
            class="btn bg-purple-700 text-white hover:bg-purple-800 transition text-xs sm:text-sm"
            (click)="submitForm()"
          >
            ‚ú® Finalizar
          </button>
        }
      </div>
      <p class="text-center text-gray-600 mt-3 text-xs sm:text-sm">
        ¬øYa tienes cuenta? 
        <a 
          (click)="goToLogin()" 
          class="text-purple-600 font-semibold cursor-pointer hover:underline"
        >
          Accede aqu√≠
        </a>
      </p>
    </div>
  </div>
</div>
